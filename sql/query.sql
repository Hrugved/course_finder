WITH course_filtered_types AS (
	SELECT DISTINCT course_id FROM course_types 
    WHERE course_type in ("REGULAR","DE")
),
course_filtered_branch AS (
	SELECT * FROM course
    WHERE branch in ("AE")
),
course_filtered_branch_credits AS (
	SELECT * FROM course_filtered_branch
    WHERE credits BETWEEN 5 AND 9
),
course_filtered_branch_credits_types AS (
	SELECT * FROM course_filtered_branch_credits
    INNER JOIN course_filtered_types USING (course_id)
),
course_clash_filtered_branch_credits_types AS (
	SELECT *, (CONV(HEX(sched_bitmap & b'000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'),16,10)!=0) AS clash FROM course_filtered_branch_credits_types
)
SELECT * FROM course_clash_filtered_branch_credits_types
WHERE clash = 0;

